Phar-файл
=========

.. caution::

    Использование файла ``phar`` признано устаревшим. Вместо этого, для установки Silex и зависимостей вы должны
    использовать Composer или скачать один из архивов.

Установка
---------

Установка Silex проста также, как скачивание `phar
<http://silex.sensiolabs.org/get/silex.phar>`_ и сохранение его где-нибудь на диске.
Затем, вы должны объвить его требующимся в вашем скрипте::

    <?php

    require_once __DIR__.'/silex.phar';

    $app = new Silex\Application();

    $app->get('/hello/{name}', function ($name) use ($app) {
        return 'Hello '.$app->escape($name);
    });

    $app->run();

Консоль
-------

Silex включает легковесную консоль для обновления до последней версии.

Для определения используемой вами версии Silex, вызовете в командной строке ``silex.phar`` с указанием
аргумента ``version``:

.. code-block:: text

    $ php silex.phar version
    Silex version 0a243d3 2011-04-17 14:49:31 +0200

Для проверки того, что вы используете последнюю версию, запустите команду ``check``:

.. code-block:: text

    $ php silex.phar check

Для обновления ``silex.phar`` до последней версии, вызовете команду ``update``:

.. code-block:: text

    $ php silex.phar update

Это позволит автоматически скачать новый ``silex.phar`` с сайта ``silex.sensiolabs.org`` и заменить существующий.

Подводные камни
---------------

Существую несколько особенностей, из-за которых всё может пойти не так, как ожидается.
Здесь мы попытаемся описать наиболее часто встречающиеся.

Конфигурация PHP
~~~~~~~~~~~~~~~~

Некоторые дистрибутивы PHP имеют настройки по умолчанию, ограничивающие Phar.
Установка следующего должна помочь.

.. code-block:: ini

    detect_unicode = Off
    phar.readonly = Off
    phar.require_hash = Off

Если вы используете Suhosin, вам также требуется установить это:

.. code-block:: ini

    suhosin.executor.include.whitelist = phar

.. note::

    В Ubuntu PHP поставляется с Suhosin, поэтому если вы используете Ubuntu, вам необходимо сделать это изменение.

Ошибка Phar
~~~~~~~~~~~

В некоторые случаях PHP содержит ошибку, котороя выбрасывает исключение ``PharException`` при попытке включения Phar.
Также вам сообщается о невозможности найти ``Silex\Application``.
Решение заключается в использовании следующей строки включения::

    require_once 'phar://'.__DIR__.'/silex.phar/autoload.php';

Точная причина этой неполадки всё ещё не известна.

Ошибка загрузчика Ioncube
~~~~~~~~~~~~~~~~~~~~~~~~~

Загрузчик Ioncube - это расширение, которое расшифровывает зашифрованные PHP-файлы.
К сожалению, старые версии (до версии 4.0.9) не работают с phar-архивами.
Вы должны обновить Ioncube до версии 4.0.9 или более новой, или же отключить его в php.ini, закоментировав
или удалив строку:

.. code-block:: ini

    zend_extension = /usr/lib/php5/20090626+lfs/ioncube_loader_lin_5.3.so
